{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import NavBar from'../NavBar/NavBar';import useForm from\"../../hooks/useForm\";import{CurrentUserContext}from\"../../contexts/CurrentUserContext\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const emailRegex=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;function Profile(props){const[profileChange,setProfileChange]=useState(false);const{values,setValues}=useForm({});const[formValid,setFormValid]=useState(false);const[formErr,setFormErr]=useState(\"\");const profileData=React.useContext(CurrentUserContext);function isEmailValid(email){return emailRegex.test(email);}function isNameValid(name){return typeof name==='string'&&name.length>=2;}function validateForm(email,name){const isEmail=isEmailValid(email);const isName=isNameValid(name);return isEmail&&isName;}function handleChange(e){const{name,value}=e.target;setValues({...values,[name]:value});}function changeProfile(){setProfileChange(true);setValues({name:profileData.name,email:profileData.email});}function handleSubmit(e){e.preventDefault();if(values.email&&!emailRegex.test(values.email)){setFormErr(\"Введите корректный email\");return;}props.onUpdateUser({name:values.name,email:values.email});setProfileChange(false);}useEffect(()=>{const isFormValid=validateForm(values.email,values.name);setFormValid(isFormValid);},[values.email,values.name]);useEffect(()=>{if(profileChange){if(values.name===profileData.name&&values.email===profileData.email){setFormErr(\"Одинаковые данные\");setFormValid(true);}else{setFormErr(\"\");setFormValid(false);}}if(!emailRegex.test(values.email)){setFormErr(\"Некорректная почта\");setFormValid(true);}else{setFormErr(\"\");setFormValid(false);}},[values.name,values.email,profileChange,profileData]);return/*#__PURE__*/_jsxs(\"main\",{className:\"profile\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"profile__title\",children:[\"\\u041F\\u0440\\u0438\\u0432\\u0435\\u0442, \",profileData.name||'Пользователь',\"!\"]}),/*#__PURE__*/_jsxs(\"form\",{className:profileChange?\"profile__form profile__form_margin\":\"profile__form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__info\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"profile__info-type\",children:\"\\u0418\\u043C\\u044F\"}),profileChange?/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,name:\"name\",maxLength:30,minLength:2,required:true,className:\"profile__info-item profile__info-name profile__input\",placeholder:\"Имя\",value:values.name||\"\"}):/*#__PURE__*/_jsx(\"p\",{className:\"profile__info-item profile__info-name\",children:profileData.name||'Пользователь'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"profile__info-type\",children:\"E-mail\"}),profileChange?/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,value:values.email||\"\",type:\"email\",name:\"email\",maxLength:30,minLength:2,required:true,className:\"profile__info-item profile__info-name profile__input\",placeholder:\"E-mail\"}):/*#__PURE__*/_jsx(\"p\",{className:\"profile__info-item profile__info-email\",children:profileData.email||\"pochta@yandex.ru\"})]}),profileChange?/*#__PURE__*/_jsx(\"span\",{className:\"sign-data__input-error profile-data__input-error\",children:formErr}):\"\",profileChange?/*#__PURE__*/_jsx(\"button\",{className:\"profile__form-submit\",disabled:formValid,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}):\"\"]}),profileChange?\"\":/*#__PURE__*/_jsxs(\"div\",{className:\"profile__under-submit-container\",children:[profileChange?\"\":/*#__PURE__*/_jsx(\"button\",{className:\"profile__button\",onClick:changeProfile,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(NavBar,{name:\"Выйти из аккаунта\",path:\"\",className:\"profile__link\",signOut:props.signOut})]})]});}export default Profile;","map":{"version":3,"names":["React","useEffect","useState","NavBar","useForm","CurrentUserContext","jsxs","_jsxs","jsx","_jsx","emailRegex","Profile","props","profileChange","setProfileChange","values","setValues","formValid","setFormValid","formErr","setFormErr","profileData","useContext","isEmailValid","email","test","isNameValid","name","length","validateForm","isEmail","isName","handleChange","e","value","target","changeProfile","handleSubmit","preventDefault","onUpdateUser","isFormValid","className","children","onSubmit","onChange","maxLength","minLength","required","placeholder","type","disabled","onClick","path","signOut"],"sources":["C:/Users/79267/desktop/praktikum/dev/movies-explorer-frontend-no-api/src/components/Profile/Profile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport NavBar from '../NavBar/NavBar';\r\nimport useForm from \"../../hooks/useForm\";\r\nimport { CurrentUserContext } from \"../../contexts/CurrentUserContext\";\r\n\r\nconst emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;\r\n\r\nfunction Profile(props) {\r\n    const [profileChange, setProfileChange] = useState(false);\r\n    const { values, setValues } = useForm({});\r\n    const [formValid, setFormValid] = useState(false);\r\n    const [formErr, setFormErr] = useState(\"\");\r\n\r\n    const profileData = React.useContext(CurrentUserContext);\r\n\r\n    function isEmailValid(email) {\r\n        return emailRegex.test(email);\r\n    }\r\n\r\n    function isNameValid(name) {\r\n        return typeof name === 'string' && name.length >= 2;\r\n    }\r\n\r\n    function validateForm(email, name) {\r\n        const isEmail = isEmailValid(email);\r\n        const isName = isNameValid(name)\r\n        return isEmail && isName;\r\n    }\r\n\r\n    function handleChange(e) {\r\n        const { name, value } = e.target;\r\n        setValues({ ...values, [name]: value });\r\n    }\r\n\r\n    function changeProfile() {\r\n        setProfileChange(true);\r\n        setValues({ name: profileData.name, email: profileData.email });\r\n    }\r\n\r\n    function handleSubmit(e) {\r\n        e.preventDefault();\r\n        if (values.email && !emailRegex.test(values.email)) {\r\n            setFormErr(\"Введите корректный email\");\r\n            return;\r\n        }\r\n        props.onUpdateUser({\r\n            name: values.name,\r\n            email: values.email,\r\n        });\r\n        setProfileChange(false);\r\n    }\r\n\r\n    useEffect(() => {\r\n        const isFormValid = validateForm(values.email, values.name);\r\n        setFormValid(isFormValid);\r\n    }, [values.email, values.name]);\r\n\r\n    useEffect(() => {\r\n        if (profileChange) {\r\n            if (values.name === profileData.name && values.email === profileData.email) {\r\n                setFormErr(\"Одинаковые данные\");\r\n                setFormValid(true);\r\n            } else {\r\n                setFormErr(\"\");\r\n                setFormValid(false);\r\n            }\r\n        }\r\n\r\n        if(!emailRegex.test(values.email)) {\r\n            setFormErr(\"Некорректная почта\");\r\n            setFormValid(true);\r\n        } else {\r\n            setFormErr(\"\");\r\n            setFormValid(false);\r\n        }\r\n    }, [values.name, values.email, profileChange, profileData]);\r\n\r\n    return (\r\n        <main className=\"profile\">\r\n            <h1 className=\"profile__title\">Привет, {profileData.name || 'Пользователь'}!</h1>\r\n            <form className={profileChange ? \"profile__form profile__form_margin\" : \"profile__form\"} onSubmit={handleSubmit}>\r\n                <div className=\"profile__info\">\r\n                    <h2 className=\"profile__info-type\">Имя</h2>\r\n                    {profileChange ? <input onChange={handleChange} name=\"name\" maxLength={30} minLength={2} required\r\n                        className=\"profile__info-item profile__info-name profile__input\"\r\n                        placeholder={\"Имя\"} value={values.name || \"\"}>\r\n                    </input>\r\n                        : <p className=\"profile__info-item profile__info-name\">{profileData.name || 'Пользователь'}</p>}\r\n                </div>\r\n                <div className=\"profile__info\">\r\n                    <h3 className=\"profile__info-type\">E-mail</h3>\r\n                    {profileChange ? <input onChange={handleChange} value={values.email || \"\"} type=\"email\"\r\n                        name=\"email\" maxLength={30} minLength={2} required\r\n                        className=\"profile__info-item profile__info-name profile__input\" placeholder={\"E-mail\"}></input>\r\n                        : <p className=\"profile__info-item profile__info-email\">{profileData.email || \"pochta@yandex.ru\"}</p>}\r\n                </div>\r\n                {profileChange ? <span className=\"sign-data__input-error profile-data__input-error\">\r\n                    {formErr}\r\n                </span> : \"\"}\r\n                {profileChange ? <button className=\"profile__form-submit\"\r\n                    disabled={formValid}>Сохранить</button> : \"\"}\r\n            </form>\r\n            {profileChange ? \"\" : <div className=\"profile__under-submit-container\">\r\n                {profileChange ? \"\" : <button className=\"profile__button\" onClick={changeProfile}>Редактировать</button>}\r\n                <NavBar name={\"Выйти из аккаунта\"} path={\"\"} className={\"profile__link\"} signOut={props.signOut} />\r\n            </div>}\r\n        </main>\r\n    );\r\n}\r\n\r\nexport default Profile;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}