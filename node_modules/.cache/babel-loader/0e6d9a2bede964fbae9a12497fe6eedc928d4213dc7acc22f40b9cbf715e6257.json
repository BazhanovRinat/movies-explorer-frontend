{"ast":null,"code":"import _defineProperty from\"C:/Users/79267/Desktop/praktikum/dev/movies-explorer-frontend-no-api/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/79267/Desktop/praktikum/dev/movies-explorer-frontend-no-api/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/79267/Desktop/praktikum/dev/movies-explorer-frontend-no-api/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import NavBar from'../NavBar/NavBar';import useForm from\"../../hooks/useForm\";import{CurrentUserContext}from\"../../contexts/CurrentUserContext\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var emailRegex=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;function Profile(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),profileChange=_useState2[0],setProfileChange=_useState2[1];var _useForm=useForm({}),values=_useForm.values,setValues=_useForm.setValues;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),formValid=_useState4[0],setFormValid=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),formErr=_useState6[0],setFormErr=_useState6[1];var profileData=React.useContext(CurrentUserContext);function isEmailValid(email){return emailRegex.test(email);}function isNameValid(name){return typeof name==='string'&&name.length>=2;}function validateForm(email,name){var isEmail=isEmailValid(email);var isName=isNameValid(name);return isEmail&&isName;}function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setValues(_objectSpread(_objectSpread({},values),{},_defineProperty({},name,value)));}function changeProfile(){setProfileChange(true);setValues({name:profileData.name,email:profileData.email});}function handleSubmit(e){e.preventDefault();if(values.email&&!emailRegex.test(values.email)){setFormErr(\"Введите корректный email\");return;}props.onUpdateUser({name:values.name,email:values.email});setProfileChange(false);}useEffect(function(){var isFormValid=validateForm(values.email,values.name);setFormValid(isFormValid);},[values.email,values.name]);useEffect(function(){if(profileChange){if(values.name===profileData.name&&values.email===profileData.email){setFormErr(\"Одинаковые данные\");setFormValid(true);}else{setFormErr(\"\");setFormValid(false);}}if(!emailRegex.test(values.email)){setFormErr(\"Некорректная почта\");setFormValid(true);}else{setFormErr(\"\");setFormValid(false);}},[values.name,values.email,profileChange,profileData]);return/*#__PURE__*/_jsxs(\"main\",{className:\"profile\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"profile__title\",children:[\"\\u041F\\u0440\\u0438\\u0432\\u0435\\u0442, \",profileData.name||'Пользователь',\"!\"]}),/*#__PURE__*/_jsxs(\"form\",{className:profileChange?\"profile__form profile__form_margin\":\"profile__form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile__info\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"profile__info-type\",children:\"\\u0418\\u043C\\u044F\"}),profileChange?/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,name:\"name\",maxLength:30,minLength:2,required:true,className:\"profile__info-item profile__info-name profile__input\",placeholder:\"Имя\",value:values.name||\"\"}):/*#__PURE__*/_jsx(\"p\",{className:\"profile__info-item profile__info-name\",children:profileData.name||'Пользователь'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile__info\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"profile__info-type\",children:\"E-mail\"}),profileChange?/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,value:values.email||\"\",type:\"email\",name:\"email\",maxLength:30,minLength:2,required:true,className:\"profile__info-item profile__info-name profile__input\",placeholder:\"E-mail\"}):/*#__PURE__*/_jsx(\"p\",{className:\"profile__info-item profile__info-email\",children:profileData.email||\"pochta@yandex.ru\"})]}),profileChange?/*#__PURE__*/_jsx(\"span\",{className:\"sign-data__input-error profile-data__input-error\",children:formErr}):\"\",profileChange?/*#__PURE__*/_jsx(\"button\",{className:\"profile__form-submit\",disabled:formValid,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}):\"\"]}),profileChange?\"\":/*#__PURE__*/_jsxs(\"div\",{className:\"profile__under-submit-container\",children:[profileChange?\"\":/*#__PURE__*/_jsx(\"button\",{className:\"profile__button\",onClick:changeProfile,children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(NavBar,{name:\"Выйти из аккаунта\",path:\"\",className:\"profile__link\",signOut:props.signOut})]})]});}export default Profile;","map":{"version":3,"names":["React","useEffect","useState","NavBar","useForm","CurrentUserContext","jsxs","_jsxs","jsx","_jsx","emailRegex","Profile","props","_useState","_useState2","_slicedToArray","profileChange","setProfileChange","_useForm","values","setValues","_useState3","_useState4","formValid","setFormValid","_useState5","_useState6","formErr","setFormErr","profileData","useContext","isEmailValid","email","test","isNameValid","name","length","validateForm","isEmail","isName","handleChange","e","_e$target","target","value","_objectSpread","_defineProperty","changeProfile","handleSubmit","preventDefault","onUpdateUser","isFormValid","className","children","onSubmit","onChange","maxLength","minLength","required","placeholder","type","disabled","onClick","path","signOut"],"sources":["C:/Users/79267/desktop/praktikum/dev/movies-explorer-frontend-no-api/src/components/Profile/Profile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport NavBar from '../NavBar/NavBar';\r\nimport useForm from \"../../hooks/useForm\";\r\nimport { CurrentUserContext } from \"../../contexts/CurrentUserContext\";\r\n\r\nconst emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;\r\n\r\nfunction Profile(props) {\r\n    const [profileChange, setProfileChange] = useState(false);\r\n    const { values, setValues } = useForm({});\r\n    const [formValid, setFormValid] = useState(false);\r\n    const [formErr, setFormErr] = useState(\"\");\r\n\r\n    const profileData = React.useContext(CurrentUserContext);\r\n\r\n    function isEmailValid(email) {\r\n        return emailRegex.test(email);\r\n    }\r\n\r\n    function isNameValid(name) {\r\n        return typeof name === 'string' && name.length >= 2;\r\n    }\r\n\r\n    function validateForm(email, name) {\r\n        const isEmail = isEmailValid(email);\r\n        const isName = isNameValid(name)\r\n        return isEmail && isName;\r\n    }\r\n\r\n    function handleChange(e) {\r\n        const { name, value } = e.target;\r\n        setValues({ ...values, [name]: value });\r\n    }\r\n\r\n    function changeProfile() {\r\n        setProfileChange(true);\r\n        setValues({ name: profileData.name, email: profileData.email });\r\n    }\r\n\r\n    function handleSubmit(e) {\r\n        e.preventDefault();\r\n        if (values.email && !emailRegex.test(values.email)) {\r\n            setFormErr(\"Введите корректный email\");\r\n            return;\r\n        }\r\n        props.onUpdateUser({\r\n            name: values.name,\r\n            email: values.email,\r\n        });\r\n        setProfileChange(false);\r\n    }\r\n\r\n    useEffect(() => {\r\n        const isFormValid = validateForm(values.email, values.name);\r\n        setFormValid(isFormValid);\r\n    }, [values.email, values.name]);\r\n\r\n    useEffect(() => {\r\n        if (profileChange) {\r\n            if (values.name === profileData.name && values.email === profileData.email) {\r\n                setFormErr(\"Одинаковые данные\");\r\n                setFormValid(true);\r\n            } else {\r\n                setFormErr(\"\");\r\n                setFormValid(false);\r\n            }\r\n        }\r\n\r\n        if(!emailRegex.test(values.email)) {\r\n            setFormErr(\"Некорректная почта\");\r\n            setFormValid(true);\r\n        } else {\r\n            setFormErr(\"\");\r\n            setFormValid(false);\r\n        }\r\n    }, [values.name, values.email, profileChange, profileData]);\r\n\r\n    return (\r\n        <main className=\"profile\">\r\n            <h1 className=\"profile__title\">Привет, {profileData.name || 'Пользователь'}!</h1>\r\n            <form className={profileChange ? \"profile__form profile__form_margin\" : \"profile__form\"} onSubmit={handleSubmit}>\r\n                <div className=\"profile__info\">\r\n                    <h2 className=\"profile__info-type\">Имя</h2>\r\n                    {profileChange ? <input onChange={handleChange} name=\"name\" maxLength={30} minLength={2} required\r\n                        className=\"profile__info-item profile__info-name profile__input\"\r\n                        placeholder={\"Имя\"} value={values.name || \"\"}>\r\n                    </input>\r\n                        : <p className=\"profile__info-item profile__info-name\">{profileData.name || 'Пользователь'}</p>}\r\n                </div>\r\n                <div className=\"profile__info\">\r\n                    <h3 className=\"profile__info-type\">E-mail</h3>\r\n                    {profileChange ? <input onChange={handleChange} value={values.email || \"\"} type=\"email\"\r\n                        name=\"email\" maxLength={30} minLength={2} required\r\n                        className=\"profile__info-item profile__info-name profile__input\" placeholder={\"E-mail\"}></input>\r\n                        : <p className=\"profile__info-item profile__info-email\">{profileData.email || \"pochta@yandex.ru\"}</p>}\r\n                </div>\r\n                {profileChange ? <span className=\"sign-data__input-error profile-data__input-error\">\r\n                    {formErr}\r\n                </span> : \"\"}\r\n                {profileChange ? <button className=\"profile__form-submit\"\r\n                    disabled={formValid}>Сохранить</button> : \"\"}\r\n            </form>\r\n            {profileChange ? \"\" : <div className=\"profile__under-submit-container\">\r\n                {profileChange ? \"\" : <button className=\"profile__button\" onClick={changeProfile}>Редактировать</button>}\r\n                <NavBar name={\"Выйти из аккаунта\"} path={\"\"} className={\"profile__link\"} signOut={props.signOut} />\r\n            </div>}\r\n        </main>\r\n    );\r\n}\r\n\r\nexport default Profile;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}