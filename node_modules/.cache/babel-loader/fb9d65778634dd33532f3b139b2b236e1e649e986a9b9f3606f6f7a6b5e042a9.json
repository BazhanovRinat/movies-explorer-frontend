{"ast":null,"code":"import _slicedToArray from\"C:/Users/79267/Desktop/praktikum/dev/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{moviesApi}from\"../../utils/MoviesApi\";import SearchForm from\"../SearchForm/SearchForm\";import MoviesCardList from\"../MoviesCardList/MoviesCardList\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Movies(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),allMovies=_useState2[0],setAllMovies=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),filteredMovies=_useState4[0],setFilteredMovies=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),visibleMovies=_useState6[0],setVisibleMovies=_useState6[1];var _useState7=useState(16),_useState8=_slicedToArray(_useState7,2),maxVisibleMovies=_useState8[0],setMaxVisibleMovies=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),searched=_useState10[0],setSearched=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isShortMovies=_useState12[0],setIsShortMovies=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isLoading=_useState14[0],setIsLoading=_useState14[1];var screenWidth=window.innerWidth;useEffect(function(){var usersMovies=JSON.parse(localStorage.getItem('oldMovies'));if(usersMovies){setAllMovies(usersMovies);setFilteredMovies(usersMovies);setSearched(true);updateVisibleMovies();}},[]);function findMovie(filter,isShortMovies){moviesApi.getMovies().then(function(data){setIsLoading(true);var filteredMovies=data.filter(function(_ref){var nameRU=_ref.nameRU;return nameRU.toLowerCase().includes(filter.toLowerCase());});if(isShortMovies===true){filteredMovies=filteredMovies.filter(function(_ref2){var duration=_ref2.duration;return duration<=40;});}setAllMovies(filteredMovies);localStorage.setItem('oldMovies',JSON.stringify(filteredMovies));if(isShortMovies){setFilteredMovies(filteredMovies);}else{setFilteredMovies(allMovies);}if(screenWidth<=1150){setMaxVisibleMovies(15);}else{setMaxVisibleMovies(16);}setSearched(true);}).catch(function(error){console.log(\"\".concat(error));}).finally(function(){setIsLoading(false);});}function handleCheckboxChange(){setIsShortMovies(!isShortMovies);if(!isShortMovies){setFilteredMovies(allMovies.filter(function(_ref3){var duration=_ref3.duration;return duration<=40;}));}else{setFilteredMovies(allMovies);}}function loadMoreMovies(){var cardsToAdd=4;if(screenWidth<=1150){cardsToAdd=3;}if(screenWidth<=480){cardsToAdd=2;}setMaxVisibleMovies(function(currentMaxVisibleMovies){return currentMaxVisibleMovies+cardsToAdd;});}useEffect(function(){if(searched){updateVisibleMovies();}},[filteredMovies,maxVisibleMovies,searched]);function updateVisibleMovies(){var moviesToShow=filteredMovies.slice(0,maxVisibleMovies);setVisibleMovies(moviesToShow);}return/*#__PURE__*/_jsxs(\"main\",{className:\"movies\",children:[/*#__PURE__*/_jsx(SearchForm,{findMovie:findMovie,handleCheckboxChange:handleCheckboxChange,isShortMovies:isShortMovies}),searched&&filteredMovies.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"\\u0424\\u0438\\u043B\\u044C\\u043C \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[searched&&/*#__PURE__*/_jsx(MoviesCardList,{movies:visibleMovies,isLoading:isLoading}),searched&&visibleMovies.length<filteredMovies.length&&/*#__PURE__*/_jsx(\"button\",{className:\"movies__moreMovies-btn\",onClick:loadMoreMovies,children:\"\\u0415\\u0449\\u0435\"})]})]});}export default Movies;","map":{"version":3,"names":["React","useState","useEffect","moviesApi","SearchForm","MoviesCardList","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Movies","_useState","_useState2","_slicedToArray","allMovies","setAllMovies","_useState3","_useState4","filteredMovies","setFilteredMovies","_useState5","_useState6","visibleMovies","setVisibleMovies","_useState7","_useState8","maxVisibleMovies","setMaxVisibleMovies","_useState9","_useState10","searched","setSearched","_useState11","_useState12","isShortMovies","setIsShortMovies","_useState13","_useState14","isLoading","setIsLoading","screenWidth","window","innerWidth","usersMovies","JSON","parse","localStorage","getItem","updateVisibleMovies","findMovie","filter","getMovies","then","data","_ref","nameRU","toLowerCase","includes","_ref2","duration","setItem","stringify","catch","error","console","log","concat","finally","handleCheckboxChange","_ref3","loadMoreMovies","cardsToAdd","currentMaxVisibleMovies","moviesToShow","slice","className","children","length","movies","onClick"],"sources":["C:/Users/79267/Desktop/praktikum/dev/movies-explorer-frontend/src/components/Movies/Movies.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { moviesApi } from \"../../utils/MoviesApi\";\r\nimport SearchForm from \"../SearchForm/SearchForm\";\r\nimport MoviesCardList from \"../MoviesCardList/MoviesCardList\";\r\n\r\nfunction Movies() {\r\n    const [allMovies, setAllMovies] = useState([]);\r\n    const [filteredMovies, setFilteredMovies] = useState([]);\r\n    const [visibleMovies, setVisibleMovies] = useState([]);\r\n    const [maxVisibleMovies, setMaxVisibleMovies] = useState(16);\r\n    const [searched, setSearched] = useState(false);\r\n    const [isShortMovies, setIsShortMovies] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const screenWidth = window.innerWidth;\r\n\r\n    useEffect(() => {\r\n        const usersMovies = JSON.parse(localStorage.getItem('oldMovies'));\r\n        if (usersMovies) {\r\n            setAllMovies(usersMovies);\r\n            setFilteredMovies(usersMovies);\r\n            setSearched(true);\r\n            updateVisibleMovies();\r\n        }\r\n    }, []);\r\n\r\n    function findMovie(filter, isShortMovies) {\r\n        moviesApi.getMovies()\r\n            .then((data) => {\r\n                setIsLoading(true);\r\n                let filteredMovies = data.filter(({ nameRU }) => nameRU.toLowerCase().includes(filter.toLowerCase()));\r\n                if (isShortMovies === true) {\r\n                    filteredMovies = filteredMovies.filter(({ duration }) => duration <= 40);\r\n                }\r\n                setAllMovies(filteredMovies);\r\n                localStorage.setItem('oldMovies', JSON.stringify(filteredMovies));\r\n                if (isShortMovies) {\r\n                    setFilteredMovies(filteredMovies);\r\n                } else {\r\n                    setFilteredMovies(allMovies);\r\n                }\r\n                if (screenWidth <= 1150) {\r\n                    setMaxVisibleMovies(15);\r\n                } else {\r\n                    setMaxVisibleMovies(16);\r\n                }\r\n                setSearched(true);\r\n            })\r\n            .catch((error) => {\r\n                console.log(`${error}`);\r\n            })\r\n            .finally(() => {\r\n                setIsLoading(false);\r\n            });\r\n    }\r\n\r\n        function handleCheckboxChange() {\r\n            setIsShortMovies(!isShortMovies);\r\n            if (!isShortMovies) {\r\n                setFilteredMovies(allMovies.filter(({ duration }) => duration <= 40));\r\n            } else {\r\n                setFilteredMovies(allMovies);\r\n            }\r\n        }\r\n\r\n        function loadMoreMovies() {\r\n            let cardsToAdd = 4;\r\n            if (screenWidth <= 1150) {\r\n                cardsToAdd = 3;\r\n            }\r\n            if (screenWidth <= 480) {\r\n                cardsToAdd = 2;\r\n            }\r\n            setMaxVisibleMovies(currentMaxVisibleMovies => currentMaxVisibleMovies + cardsToAdd);\r\n        }\r\n\r\n        useEffect(() => {\r\n            if (searched) {\r\n                updateVisibleMovies();\r\n            }\r\n        }, [filteredMovies, maxVisibleMovies, searched]);\r\n\r\n        function updateVisibleMovies() {\r\n            const moviesToShow = filteredMovies.slice(0, maxVisibleMovies);\r\n            setVisibleMovies(moviesToShow);\r\n        }\r\n\r\n        return (\r\n            <main className=\"movies\">\r\n                <SearchForm findMovie={findMovie} handleCheckboxChange={handleCheckboxChange} isShortMovies={isShortMovies} />\r\n                {searched && filteredMovies.length === 0 ? (\r\n                    <p>Фильм не найден</p>\r\n                ) : (\r\n                    <>\r\n                        {searched && <MoviesCardList movies={visibleMovies} isLoading={isLoading} />}\r\n                        {searched && visibleMovies.length < filteredMovies.length && (\r\n                            <button className=\"movies__moreMovies-btn\" onClick={loadMoreMovies}>Еще</button>\r\n                        )}\r\n                    </>\r\n                )}\r\n            </main>\r\n        );\r\n    }\r\n\r\n    export default Movies;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}